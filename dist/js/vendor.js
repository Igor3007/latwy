class afLightbox{constructor(e){this.modal="",e&&(this.mobileBottom=e.mobileInBottom||!1)}init(){}createTemplate(){var e=document.createElement("div");return e.innerHTML='<div class="af-popup"> <div class="af-popup__bg"></div><div class="af-popup__wrp"><div class="af-popup__container"><div class="af-popup__close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"></path></svg></div><div class="af-popup__content"></div></div></div></div>',document.body.append(e),this.instanse=e}open(e,t){let s=this;this.modal=this.createTemplate(),window.innerWidth<=480&&this.mobileBottom&&this.modal.querySelector(".af-popup").classList.add("af-popup--mobile"),document.body.classList.add("page-hidden"),this.modal.querySelector(".af-popup__content").innerHTML=e,this.modal.querySelector(".af-popup__close").addEventListener("click",function(){s.close()}),this.modal.querySelector('[data-af-popup="close"]')&&this.modal.querySelector('[data-af-popup="close"]').addEventListener("click",function(e){s.close()}),t&&t(this.modal),setTimeout(()=>{this.modal.querySelector(".af-popup").classList.add("af-popup--visible")},10),this.createEvent()}changeContent(e){this.modal.querySelector(".af-popup__content").innerHTML=e}createEvent(){let t=this;this.instanse.querySelector(".af-popup").addEventListener("click",function(e){e.target.closest(".af-popup__container")||t.close()})}close(){document.body.classList.contains("page-hidden")&&document.body.classList.remove("page-hidden"),this.instanse.querySelector(".af-popup").classList.remove("af-popup--visible"),setTimeout(()=>{this.instanse.remove()},300)}}class afSelect{constructor(e){this.selector=e.selector,this.selectAll=document.querySelectorAll(this.selector),this.on=e.on||!1}init(){this.renderTemplate(),this.clickEventOut()}reinit(e){e=e.parentNode;e.querySelector(".select-styled")&&(e.querySelector(".select-styled").remove(),e.querySelector(".select-list").remove(),e.querySelectorAll("[selected]").forEach(e=>e.removeAttribute("selected"))),this.renderOption(e),this.clickEventOpenSelect(e),e.classList.remove("af-select--selected")}ajaxOption(e,t){let s=new XMLHttpRequest;return s.open("GET",e.dataset.ajax),s.responseType="json",s.setRequestHeader("Content-type","application/json; charset=utf-8"),s.send(),s.onerror=function(){console.err("Error: afSelect ajax request failed")},s.onreadystatechange=function(){3==s.readyState&&e.closest(".af-select").querySelector(".select-list").classList.add("select-list--load"),4==s.readyState&&e.closest(".af-select").querySelector(".select-list").classList.remove("select-list--load")},s.onload=function(){t(s.response)},null}renderOption(a){var n=this,l=a.querySelector("select"),i=l.getAttribute("placeholder"),t=l.getAttribute("data-label"),r=l.getAttribute("multiple");let o=document.createElement("div"),c=(o.classList.add("select-styled"),o.innerHTML="<span>"+i+"</span>",document.createElement("ul")),s=(c.classList.add("select-options"),document.createElement("div"));function d(e){e.querySelectorAll("select > option").forEach(function(e,t){var s,a=document.createElement("li");function l(e){if(r){let t=[];return e.parentNode.querySelectorAll("option[selected]").forEach(function(e){t.push(e.innerText)}),t.length?t.join(", "):i}return e.innerText}a.innerHTML=e.innerText,a.setAttribute("rel",e.value),r&&((s=document.createElement("span")).classList.add("af-check-multiple"),a.append(s)),0!=t||i||(o.innerHTML="<span>"+e.innerText+"</span>"),e.getAttribute("selected")&&(o.innerHTML=i?'<span class="af-selected-placeholder" data-af-placeholder="'+i+'">'+l(e)+"</span>":"<span>"+l(e)+"</span>",a.classList.add("active")),e.getAttribute("disabled")||(c.appendChild(a),n.clickEventListItem(a,e,t))}),e.querySelectorAll("select > option[selected]").length?e.closest(".af-select").classList.add("af-select--selected"):o.innerHTML='<span class="af-selected-placeholder" data-af-placeholder="'+i+'">'+t+"</span>"}s.classList.add("select-list"),s.appendChild(c),a.querySelector(".select-styled")||a.appendChild(o),a.querySelector(".select-options")||a.appendChild(s);let p=()=>{var e;"false"!=l.getAttribute("data-find")&&5<l.querySelectorAll("option").length&&((e=document.createElement("input")).setAttribute("type","text"),e.setAttribute("placeholder","Поиск по списку"),s.querySelector("input")||s.prepend(e),e.addEventListener("keyup",e=>{this.findOption(e)}))};l.dataset.ajax&&this.ajaxOption(l,e=>{l.innerHTML="";let s=l.dataset.selected;var t=l.getAttribute("placeholder");e.unshift({text:t||"-Выберите-",value:""}),e.forEach(function(e){var t=document.createElement("option");t.value=e.value,t.innerText=e.text,s==e.value&&(t.setAttribute("selected",!0),l.removeAttribute("data-selected")),l.append(t)}),d(a),p()}),l.dataset.ajax||d(a),p(),l.afSelect=new Object,l.afSelect.open=function(){n.openSelect(a)},l.afSelect.close=function(){n.closeSelect()},l.afSelect.update=function(){n.reinit(l)}}findOption(e){var t=e.target.closest(".select-list").querySelectorAll("li");let s=e.target.value;t.forEach(e=>{-1!==e.innerText.toLowerCase().indexOf(s.toLowerCase())?e.style.display="block":e.style.display="none"})}renderTemplate(){let s=this,a=[];this.selectAll.forEach(function(e,t){var s;e.classList.contains("select-hidden")||(e.classList.add("select-hidden"),(s=document.createElement("div")).classList.add("af-select"),e.getAttribute("multiple")&&s.classList.add("af-select--multiple"),e.getAttribute("data-label")&&s.setAttribute("data-title",e.getAttribute("data-label")),s.innerHTML=e.outerHTML,e.parentNode.replaceChild(s,e),a.push(s))}),a.forEach(function(e,t){s.renderOption(e),s.clickEventOpenSelect(e)})}openSelect(e){if(e.querySelector(".select-styled.active"))return this.closeSelect(),!1;document.querySelector(".select-styled.active")&&document.querySelectorAll(".select-styled.active").forEach(e=>{e.closest(".af-select").querySelector("select").afSelect.close()}),e.querySelector("select").dataset.ajax&&e.querySelector(".select-styled").classList.contains("active"),window.innerHeight-e.getBoundingClientRect().bottom<250?e.classList.add("af-select--top"):e.classList.contains("af-select--top")&&e.classList.remove("af-select--top"),e.style.maxWidth=e.offsetWidth+"px",e.querySelector(".select-styled").classList.add("active"),e.querySelector(".select-options").classList.add("active"),e.querySelector(".select-list").classList.add("active"),document.querySelector("body").classList.add("af-select-open")}closeSelect(){if(!document.querySelector(".select-styled.active"))return!1;document.querySelector(".select-styled.active").classList.remove("active"),document.querySelector(".select-options.active").classList.remove("active"),document.querySelector(".select-list.active").classList.remove("active"),document.querySelector("body").classList.remove("af-select-open")}clickEventOut(){let t=this;document.addEventListener("click",function(e){t.closeSelect()})}clickEventListItem(e,a,t){let l=a.parentNode.parentNode,n=this,i=l.querySelector("select").getAttribute("data-label")||l.querySelector("select").getAttribute("placeholder");l.querySelector("select").getAttribute("placeholder");let r=l.querySelector("select").getAttribute("multiple"),o=l.querySelector(".select-styled");e.addEventListener("click",function(e){function t(e){if(r){let t=[];return e.parentNode.querySelectorAll("option[selected]").forEach(function(e){t.push(e.innerText)}),t.length?t.join(", "):i}return e.innerText}e.stopPropagation(),e.preventDefault(),a.closest(".af-select").classList.add("af-select--selected"),l.querySelector(".select-options li.active")&&!r&&l.querySelector(".select-options li.active").classList.remove("active"),this.classList.contains("active")?(this.classList.remove("active"),a.removeAttribute("selected")):(this.classList.add("active"),a.setAttribute("selected","selected")),i?o.innerHTML='<span class="af-selected-placeholder" data-af-placeholder="'+i+'">'+t(a)+"</span>":l.querySelector(".select-styled span").innerHTML=t(a),r||(l.querySelector("select").value=this.getAttribute("rel"));var s=new Event("change");l.querySelector("select").dispatchEvent(s),e.target.classList.contains("af-check-multiple")||n.closeSelect(),n.on.change&&n.on.change(a)})}clickEventOpenSelect(e){let t=this;function s(e){e.stopPropagation(),e.preventDefault(),e.target.closest(".select-styled")&&t.openSelect(this)}e.removeEventListener("click",s),e.addEventListener("click",s)}}((e,t)=>{"object"==typeof exports&&typeof module<"u"?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=typeof globalThis<"u"?globalThis:e||self).Maska={})})(this,function(e){var l=Object.defineProperty,s=(e,t,s)=>{return a=s,(t="symbol"!=typeof t?t+"":t)in(e=e)?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,s;var a};let a={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}};class n{constructor(e={}){s(this,"opts",{}),s(this,"memo",new Map);e={...e};if(null!=e.tokens){e.tokens=e.tokensReplace?{...e.tokens}:{...a,...e.tokens};for(var t of Object.values(e.tokens))"string"==typeof t.pattern&&(t.pattern=new RegExp(t.pattern))}else e.tokens=a;Array.isArray(e.mask)&&(1<e.mask.length?e.mask=[...e.mask].sort((e,t)=>e.length-t.length):e.mask=e.mask[0]??""),""===e.mask&&(e.mask=null),this.opts=e}masked(e){return this.process(e,this.findMask(e))}unmasked(e){return this.process(e,this.findMask(e),!1)}isEager(){return!0===this.opts.eager}isReversed(){return!0===this.opts.reversed}completed(e){var t=this.findMask(e);if(null==this.opts.mask||null==t)return!1;let s=this.process(e,t).length;return"string"==typeof this.opts.mask?s>=this.opts.mask.length:"function"==typeof this.opts.mask?s>=t.length:this.opts.mask.filter(e=>s>=e.length).length===this.opts.mask.length}findMask(t){var e=this.opts.mask;if(null==e)return null;if("string"==typeof e)return e;if("function"==typeof e)return e(t);let s=this.process(t,e.slice(-1).pop()??"",!1);return e.find(e=>this.process(t,e,!1).length>=s.length)??""}escapeMask(s){let a=[],l=[];return s.split("").forEach((e,t)=>{"!"===e&&"!"!==s[t-1]?l.push(t-l.length):a.push(e)}),{mask:a.join(""),escaped:l}}process(e,t,s=!0){if(null==t)return e;var a=`value=${e},mask=${t},masked=`+(s?1:0);if(this.memo.has(a))return this.memo.get(a);let{mask:l,escaped:n}=this.escapeMask(t),i=[],r=null!=this.opts.tokens?this.opts.tokens:{},o=this.isReversed()?-1:1,c=this.isReversed()?"unshift":"push",d=this.isReversed()?0:l.length-1,p=this.isReversed()?()=>-1<v&&-1<f:()=>v<l.length&&f<e.length,u=e=>!this.isReversed()&&e<=d||this.isReversed()&&e>=d,h,m=-1,v=this.isReversed()?l.length-1:0,f=this.isReversed()?e.length-1:0;for(;p();){var y,k=l.charAt(v),g=r[k],S=null!=(null==g?void 0:g.transform)?g.transform(e.charAt(f)):e.charAt(f);if(n.includes(v)||null==g?(s&&!this.isEager()&&i[c](k),S!==k||this.isEager()?h=k:f+=o,this.isEager()||(v+=o)):(null!=S.match(g.pattern)?(i[c](S),g.repeated?(-1===m?m=v:v===d&&v!==m&&(v=m-o),d===m&&(v-=o)):g.multiple&&(v-=o),v+=o):g.multiple?(k=null!=(null==(k=i[f-o])?void 0:k.match(g.pattern)),y=l.charAt(v+o),k&&""!==y&&null==r[y]?(v+=o,f-=o):i[c]("")):S===h?h=void 0:g.optional&&(v+=o,f-=o),f+=o),this.isEager())for(;u(v)&&(null==r[l.charAt(v)]||n.includes(v));)s?i[c](l.charAt(v)):l.charAt(v)===e.charAt(f)&&(f+=o),v+=o}return this.memo.set(a,i.join("")),this.memo.get(a)}}let i=e=>JSON.parse(e.replaceAll("'",'"')),r=(e,t={})=>{var s,t={...t};return null!=e.dataset.maska&&""!==e.dataset.maska&&(t.mask=(s=e.dataset.maska).startsWith("[")&&s.endsWith("]")?i(s):s),null!=e.dataset.maskaEager&&(t.eager=o(e.dataset.maskaEager)),null!=e.dataset.maskaReversed&&(t.reversed=o(e.dataset.maskaReversed)),null!=e.dataset.maskaTokensReplace&&(t.tokensReplace=o(e.dataset.maskaTokensReplace)),null!=e.dataset.maskaTokens&&(t.tokens=(e=>{if(e.startsWith("{")&&e.endsWith("}"))return i(e);const s={};return e.split("|").forEach(e=>{const t=e.split(":");s[t[0]]={pattern:new RegExp(t[1]),optional:t[2]==="optional",multiple:t[2]==="multiple",repeated:t[2]==="repeated"}}),s})(e.dataset.maskaTokens)),t},o=e=>""===e||!!JSON.parse(e);class c{constructor(e,t={}){s(this,"items",new Map),s(this,"beforeinputEvent",e=>{var t=e.target,s=this.items.get(t);s.isEager()&&"inputType"in e&&e.inputType.startsWith("delete")&&s.unmasked(t.value).length<=1&&this.setMaskedValue(t,"")}),s(this,"inputEvent",t=>{if(!(t instanceof CustomEvent&&"input"===t.type&&null!=t.detail&&"object"==typeof t.detail&&"masked"in t.detail)){var s,a,l=t.target,n=this.items.get(l),i=l.value,r=l.selectionStart,o=l.selectionEnd;let e=i;if(n.isEager()&&(s=n.masked(i),""===(a=n.unmasked(i))&&"data"in t&&null!=t.data?e=t.data:a!==n.unmasked(s)&&(e=a)),this.setMaskedValue(l,e),"inputType"in t&&(t.inputType.startsWith("delete")||null!=r&&r<i.length))try{l.setSelectionRange(r,o)}catch{}}}),this.options=t,"string"==typeof e?this.init(Array.from(document.querySelectorAll(e)),this.getMaskOpts(t)):this.init("length"in e?Array.from(e):[e],this.getMaskOpts(t))}destroy(){for(var e of this.items.keys())e.removeEventListener("input",this.inputEvent),e.removeEventListener("beforeinput",this.beforeinputEvent);this.items.clear()}needUpdateOptions(e,t){var s=this.items.get(e),e=new n(r(e,this.getMaskOpts(t)));return JSON.stringify(s.opts)!==JSON.stringify(e.opts)}needUpdateValue(e){var t=e.dataset.maskaValue;return null==t&&""!==e.value||null!=t&&t!==e.value}getMaskOpts(e){let{onMaska:t,preProcess:s,postProcess:a,...l}=e;return l}init(e,t){for(var s of e){var a=new n(r(s,t));this.items.set(s,a),""!==s.value&&this.setMaskedValue(s,s.value),s.addEventListener("input",this.inputEvent),s.addEventListener("beforeinput",this.beforeinputEvent)}}setMaskedValue(e,t){var s=this.items.get(e);null!=this.options.preProcess&&(t=this.options.preProcess(t));let a=s.masked(t),l=s.unmasked(s.isEager()?a:t),n=s.completed(t),i={masked:a,unmasked:l,completed:n};t=a,null!=this.options.postProcess&&(t=this.options.postProcess(t)),e.value=t,e.dataset.maskaValue=t,null!=this.options.onMaska&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(e=>e(i)):this.options.onMaska(i)),e.dispatchEvent(new CustomEvent("maska",{detail:i})),e.dispatchEvent(new CustomEvent("input",{detail:i}))}}let d=new WeakMap;e.Mask=n,e.MaskInput=c,e.tokens=a,e.vMaska=(e,s)=>{var e=e instanceof HTMLInputElement?e:e.querySelector("input"),a={...s.arg};if(null!=e){t=e,setTimeout(()=>{var e;!0===(null==(e=d.get(t))?void 0:e.needUpdateValue(t))&&t.dispatchEvent(new CustomEvent("input"))});var t,l=d.get(e);if(null!=l){if(!l.needUpdateOptions(e,a))return;l.destroy()}if(null!=s.value){let t=s.value,e=e=>{t.masked=e.masked,t.unmasked=e.unmasked,t.completed=e.completed};a.onMaska=null==a.onMaska?e:Array.isArray(a.onMaska)?[...a.onMaska,e]:[a.onMaska,e]}d.set(e,new c(e,a))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});